---
layout: page
title: ポインタ
date: 2019-09-03 18:51:00 +0900
purposes:
    - ポインタの使い方の理解
---

ポインタ
--------------

### ポインタの基本的な使い方

まず、以下のソースコードを打ち込み、コンパイルして実行してみましょう。

*Pointer.c*<br>

    #include<stdio.h>

    void main(){
      int *p;
      int x;
      p=&x;
      x = 2;
      printf("*p=%d\n",*p);
    }

実行すると、以下のようになります。

*実行結果*

    *p=2

ポインタの宣言と生成

    データ型 *変数名;
    変数名 = &変数;
    
    // 例
    int *p;
    p = &x;


いろいろなポインタの使い方
----------------------

### 配列の要素の参照（１）

では、以下のようなソースコードを入力し、実行してみましょう。

*Pointer2.c*<br>

    #include<stdio.h>

    void main(){
      int a[] = {1, 2, 3, 4, 5};
      int *p;
      p = &(a[0]);
      printf("*p=%d\n",*p);
    }

実行すると、例えば以下のようになります。

*実行結果*

    *p=1;

配列の1つの要素を参照する場合、`&`の後に`()`で要素を指定する必要があります。


### 配列の要素の参照（２）

配列の先頭の要素を参照するときのみ、以下のソースコードのような配列名を記載するだけでも良いです。

*Pointer3.c*<br>

    #include<stdio.h>

    void main(){
      int a[] = {1, 2, 3, 4, 5};
      int *p;
      p = a;
      printf("*p=%d\n",*p);
    }

実行すると、例えば以下のようになります。

*実行結果*

    *p=1;


### ポインタのポインタ

ポインタを使うことによって他の変数を参照する以外にも、他のポインタを参照することもできます。以下のソースコードを実行して見ましょう。


*Pointer4.c*<br>

    #include<stdio.h>

    void main(){
      int *p1;
      int **p2;
      int x;
      x=4;
      p1 = &x;
      p2 = p1;
      printf("**p2=%d\n",**p2);
    }

実行すると、例えば以下のようになります。

*実行結果*

    **p2=4;


### ポインタによる複数の値の管理

関連する複数の変数（データ）は配列を使うことによってまとめられることは配列の回で学びました。配列は情報を一元的に管理できる利点がありますが、配列を定義するときに何個の要素をまとめるのかを決める必要があります。もし最初からまとめるデータの数が決まっている場合は問題がありませんが、そうでない場合（例えば、お客さんごとのおでんを注文する数）は配列のサイズを大きめに用意しなければなりません。配列はメモリにデータを記録するので、不必要に大きい配列はメモリの無駄遣いの原因となります。

ポインタと構造体を組み合わせて**リスト**を作成することによって必要な数だけ構造体の変数を定義することができ、最初からまとめるデータの数がわからない場合でも最低限のメモリ使用量で済むことができます。興味のある人はリストを実装し、メモリ使用量の差を確認して見ましょう。

### ポインタの発展的な使い方

上記の例のように、予め変数・配列・構造体を定義することによってデータに名前を与え、それらを参照するようにポインタを設定しても良いです。一方、`malloc`を使えば、データに対して名前を付与せずメモリに記録することもできます。このような方法はリストのように複数の要素をポインタで管理する場合に適切です。`malloc`を使うためにはファイルの最初に`#include<stdlib.h>`を書きます。次に、`p = malloc(sizeof(int))`のように記載します。これは、int型データを参照するポインタ変数を`p`とし、`p`の参照先にメモリ領域を確保します。以下のプログラムは`malloc`を使った例です。

*Pointer5.c*<br>

    #include<stdio.h>
    #include<stdlib.h>

    void main(){
      int *p;
      p = malloc(sizeof(int));
      *p = 4;
      printf("%*p=¥d\n",*p);
    }

練習問題
--------
1.	次の配列の中身を，ポインタを使って表示しましょう．
int a[] = {5, 2, 8, 56};

2. ポインタを使って，上の配列の2番目と3番目の要素を交換しましょう．

3.	double型の変数の値を，ポインタ変数を使って代入しましょう．

4.	int型の配列の各要素に1~nまでの数を，ポインタ変数を使って代入してください．

5.	文字列を記録する配列の各文字を，ポインタ変数を使って大文字に変換しましょう．

6.	int型の変数xの値を，ポインタ変数を用いて1足すプログラムを作成してください．

7.	int型の配列aを，a[0]=1, a[1]=2,…,a[9]=10とする．ポインタ*pを用いて，aの全ての要素を出力するプログラムを作成してください．

8.	ある変数の値の代入とその値の出力を行うプログラムを書きなさい. ポインタを用いること.

9.	標準入力から小文字のみからなる文字列を読み込んで, 先頭から 1 文字ずつ大文字に変えていくプログラムを書きなさい. ポインタを用いること.

10.	標準入力から文字列を読み込んで, 大文字を小文字に, 小文字を大文字に変えた文字列を出力するプログラムを書きなさい. ポインタを用いること.

11.	2 つの文字列を入力し, 先に入力された文字列の後に次に入力された文字列を繋げて 1 つにした文字列を作成して出力するプログラムを書きなさい. ポインタを用いること.

12.	10 個の数値を入力すると，その順番とは逆の順番で 10 個の数値を表示するプログラムを書きなさい. ポインタを用いること.
