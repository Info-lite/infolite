---
layout: page
title: 2つのグループの母平均の差に関する検定と推定
date: 2016-09-12 16:09:45 +0900
purposes:
    - 2つのグループの母平均に有意な差があるかどうか検定する
    - 2つのグループの母平均の差を推定する
    - JMPを用いて、2つのグループの母平均の差の検定と推定を行う
---


母平均の差に関する検定と推定
----------------------------

扱う統計データは対応のないデータと対応のあるデータの2つに分けることができます。データを統計的に処理する場合、この対応のあるなしが重要な要素となってきます。

データを見る際には注意して見ましょう。


### 対応のないデータ

一方のグループのデータが、もう一方のグループのデータとは無関係な場合のデータです。グループ内のデータの順番を入れ替えることができます。

例：2つの病棟間の最高血圧、2つのクラスの得点など

この対応のないデータの場合は、まず、等分散性の検定を行います。その後に検定と推定を行います。

- 等分散を仮定する（Studentのt検定）
    - 2つの母平均の差に関する検定
    - 2つの母平均の差の推定
-  等分散を仮定しない（Welchのt検定）
    - 2つの母平均の差に関する検定
    - 2つの母平均の差の推定（省略）


### 対応のあるデータ

一方のグループのデータともう一方のグループのデータがペアになっている場合のデータです。グループ内のデータの順番を入れ替えることができません。

例：最高血圧と最低血圧、前期と後期の得点など

こちらは、等分散性の検定を行わず、検定と推定を行うことができます。

- ２つの母平均の差に関する検定
- ２つの母平均の差の推定


### 目的変数と説明変数

複数の変数を用いて、分析を行う場合、目的変数と説明変数という概念が必要になってくる場合があります。

<dl>
<dt>目的変数(y)：被説明変数、従属変数</dt>
<dd>回帰分析などにおいて予測や要因分析を行う変数のことです。物事の結果とも言えます。被説明変数、従属変数とも呼ばれます。
回帰直線モデル (y = a<sub>0</sub> + a<sub>1</sub>x<sub>1</sub> + &hellip; + a<sub>n</sub>x<sub>n</sub>) では y に相当します。</dd>
<dt>説明変数(x)：独立変数</dt>
<dd>目的変数に影響を与えていると考えられる変数のことです。物事の原因とも言えます。独立変数とも呼ばれます。
回帰直線モデル (y = a<sub>0</sub> + a<sub>1</sub>x<sub>1</sub> + &hellip; + a<sub>n</sub>x<sub>n</sub>) では x<sub>1</sub> &hellip; x<sub>n</sub> に相当します。</dd>
</dl>


等分散を仮定したときの2つの母平均の差の検定（対応のないデータ）
---------------------------------------------------------------

### 練習問題1

ある学校のＡ組とＢ組のテスト結果について調べたところ、以下のような結果が得られました。
Ａ組とＢ組ではクラスの平均点に差があるといえるでしょうか。

表 1 ：ある学校のテスト結果（点）

![](./pic/03_01exQ.png)


### 仮説の設定

* 帰無仮説H<sub>0</sub>：&mu;<sub>A</sub> = &mu;<sub>B</sub>　Ａ組とＢ組では平均点に差があるとはいえない
* 対立仮説H<sub>1</sub>：&mu;<sub>A</sub> &ne; &mu;<sub>B</sub>　Ａ組とＢ組では平均点に差がある


### 有意水準&alpha;の設定

有意水準 &alpha; = 0.05 とします。


### 共通分散Vの算出

共通分散Ｖは以下の数式で求めることができます。

![](./pic/03_02V.png)

* S<sub>A</sub>, S<sub>B</sub> : 各グループの平方和
* n<sub>A</sub>, n<sub>B</sub> : 各グループのデータ数
* &phi;<sub>A</sub> = n<sub>A</sub> - 1, &phi;<sub>B</sub> = n<sub>B</sub> - 1

### 検定統計量t値の算出

今回は、以下の数式で検定統計量t値は求まります。

![](./pic/03_03t.png)


### p値の算出

有意水準と比較する確率p値を求めます。p値は、自由度&phi;A+&phi;Bのt分布において、|t|以上の値が発生する確率です。


### 判定

<dl>
<dt>p値 &le; 有意水準&alpha;</dt>
<dd>帰無仮説H<sub>0</sub>を棄却する</dd>
<dt>p値 &gt; 有意水準&alpha;</dt>
<dd>帰無仮説H<sub>0</sub>を棄却しない</dd>
</dl>


### JMPの操作

JMPを使って、練習 1 に取り掛かりましょう。

&#9312; まず、表 1 を入力しましょう。列を新規作成します。[列名]に `クラス` と入力し、データタイプを[文字]、尺度を[名義尺度]にします。

{% screenshot 03_04newline.png "[クラス]の列を作成" %}

&#9313; さらに、2 列目に[列名]に `点数` 、データタイプを[数値]、尺度を[連続尺度]で新規作成します。

{% screenshot 03_05newline.png "[点数]の列を作成" %}

&#9314; JMPでグループ分けをする場合、下記のような形になります。このようにデータを入力しましょう。

{% screenshot 03_06input.png "[クラス]列、[点数]列のデータを入力" %}

&#9315; メニュー[分析] - [二変量の関係]を選択します。

{% screenshot 03_07analysis.png "[分析]から[二変量の関係]をクリック" %}

&#9316; [列の選択]の中にある[クラス]をクリック - [X,説明変数]をクリック - [列の選択]の中にある[点数]をクリック - [Y,目的変数]をクリック - [OK]をクリックします。

{% screenshot 03_08analysis.png "[クラス]を[X,説明変数]、[点数]を[Y,目的変数]に割り当て" %}

{% screenshot 03_09analysis.png "一元配置分析結果" %}

&#9317; [▼クラスによる点数の一元配置分析]の[▼]をクリック - [等分散性の検定]を選択します。

{% screenshot 03_10analysis.png "[等分散性の検定]を選択" %}

#### 出力結果

{% screenshot 03_11analysis.png "検定結果" %}

p値 = 0.9301 が求まりました。設定した有意水準&alpha;は 0.05 です。
よって、p値 = 0.9301 &gt; 有意水準&alpha; = 0.05 であるので、等分散性があることがわかりました。

&#9318; 続いて、[▼クラスによる点数の一元配置分析]の[▼]をクリック - [平均/ANOVA/プーリングしたt検定]を選択します。

{% screenshot 03_12analysis.png "[平均/ANOVA/プーリングしたt検定]を選択" %}

#### 出力結果

{% screenshot 03_13analysis.png "t検定結果" %}

p値 = 0.0413 が求まりました。設定した有意水準&alpha;は 0.05 です。
よって、p値 = 0.0413 &lt; 有意水準&alpha; = 0.05 であるので、帰無仮説H<sub>0</sub>は棄却されます。
したがって、Ａ組とＢ組で点数の母平均には差があると判断します。


### JMPで検定結果を視覚的に見る方法

[▼クラスによる点数の一元配置分析]の[▼]をクリック - [平均の比較] - [各ペア,Studentのt検定]を選択します。

{% screenshot 03_14analysis.png "[各ペア,Studentのt検定]を選択" %}

#### 出力結果

{% screenshot 03_15analysis.png "Studentのt検定結果" %}

この2つの円の直径は 95 ％の信頼区間を表しています。この2つの円の重なり具合によって、有意差があるかどうかを見極めることができます。

#### 有意差なし

![](./pic/03_16circle.png)

#### 有意差有り

![](./pic/03_17circle.png)


等分散を仮定したときの2つの母平均の差の推定（対応のないデータ）
---------------------------------------------------------------

母平均の差&mu;<sub>A</sub> - &mu;<sub>B</sub>の (1-&alpha;)&times;100 ％信頼区間は、以下の式で求められます。

![](./pic/03_18interval.png)


### JMPの操作

練習 1 を継続して用います。出力結果を見てください。

{% screenshot 03_19analysis.png "t検定結果 差の上側信頼限界 = -0.813、差の下側信頼限界 = -36.217" %}

"t検定"から"差の上側信頼限界"と"差の下側信頼限定"を見ます。母平均の差&mu;<sub>A</sub> - &mu;<sub>B</sub>の 95 ％信頼区間は、0.813 &lt; &mu;<sub>A</sub> - &mu;<sub>B</sub> &lt; 36.217 となります。


等分散を仮定しないときの2つの母平均の差の検定・推定（対応のないデータ）
-----------------------------------------------------------------------

等分散を仮定しないときには検定のみになるので、推定に関しては省略します。


### 練習問題2

ある学校のＣ組とＤ組のテスト結果について調べたところ、以下のような結果が得られました。Ｃ組とＤ組ではクラスの平均点に差があるといえるでしょうか。

表 2 ：ある学校のテスト結果（点）

![](./pic/03_20exQ.png)


### 仮説の設定

* 帰無仮説H<sub>0</sub>：&mu;<sub>C</sub> = &mu;<sub>D</sub>
    * Ｃ組とＤ組では平均点に差があるとはいえない
* 対立仮説H<sub>1</sub>：&mu;<sub>C</sub> &ne; &mu;<sub>D</sub>
    * Ｃ組とＤ組では平均点に差がある


### 有意水準&alpha;の設定

有意水準&alpha; = 0.05 とします。


### 検定統計量t値の算出（Welchのt検定）

今回は、以下の数式で検定統計量t値を求めます。

![](./pic/03_21t.png)


### 等価自由度&phi;*の算出

以下の数式で、等価自由度&phi;*を求めます。

![](./pic/03_22free.png)


### p値の算出

有意水準と比較する確率p値を求めます。p値は、自由度&phi; *において、|t|以上の値が発生する確率です。


### 判定

<dl>
<dt>p値 &le; 有意水準&alpha;</dt>
<dd>帰無仮説H<sub>0</sub>を棄却する</dd>
<dt>p値 &gt; 有意水準&alpha;</dt>
<dd>帰無仮説H<sub>0</sub>を棄却しない</dd>
</dl>


### JMPの操作

JMPを用いて、練習 2 に取り掛かりましょう。

&#9312; まず、表 2 を入力しましょう。練習 1 と同じように、 1 列目は[列名]に `クラス` と入力し、
データタイプを[文字]、尺度を[名義尺度]、 2 列目は[列名]に `点数` と入力し、データタイプを[数値]、尺度を[連続尺度]と選択して列を作成してください。

{% screenshot 03_23newline.png "[クラス]の列を作成" %}

{% screenshot 03_24newline.png "[点数]の列を作成" %}

{% screenshot 03_25input.png "[クラス]列、[点数]列のデータを入力" %}

&#9313; メニュー[分析] - [二変量の関係]を選択します。

{% screenshot 03_26analysis.png "[二変量の関係]を選択" %}

&#9314; [列の選択]の中にある[クラス]をクリック - [X,説明変数]をクリック - [列の選択]の中にある[点数]をクリック - [Y,目的変数]をクリック - [OK]をクリックします。

{% screenshot 03_27analysis.png "[クラス]を[X,説明変数]、[点数]を[Y,目的変数]に割り当て" %}

{% screenshot 03_28analysis.png "クラスによる点数の一元配置分析結果" %}

&#9315; [▼クラスによる点数の一元配置分析]の[▼]をクリック - [等分散性の検定]を選択します。

{% screenshot 03_29analysis.png "[等分散性の検定]を選択" %}

#### 出力結果

{% screenshot 03_30analysis.png "検定結果" %}

Welchの分散分析の結果から、p値 = 0.0248 が求まりました。
よって、p値 = 0.0248 &lt; 有意水準&alpha; = 0.05 であるので、Ｃ組とＤ組では点数の母平均に違いがあると判断されたことになります。


2つの母平均の差の検定（対応のあるデータ）
-----------------------------------------


### 練習問題3

次のデータはある通年授業における、大学生 12 人の前期試験と後期試験の評点を示したものです。
後期試験の成績（Ｂ）は、前期試験の成績（Ａ）よりも向上していると考えられるでしょうか。

表 3 ：試験の評点（点）

![](./pic/03_31exQ.png)


### 仮説の設定

<dl>
<dt>帰無仮説H<sub>0</sub>：&mu;<sub>B</sub> - &mu;<sub>A</sub> = 0</dt>
<dd>後期の成績は前期の成績より向上しているとはいえない</dd>
<dt>対立仮説H<sub>1</sub>：&mu;<sub>B</sub> - &mu;<sub>A</sub> &gt; 0</dt>
<dd>後期の成績は前期の成績より向上している</dd>
</dl>


### 有意水準&alpha;の設定

有意水準&alpha; = 0.05 とします。


### 各ペアごとの差の算出

前期の評点と後期の評点を1つのペアとして扱います。

d<sub>i</sub> = x<sub>Ai</sub> - x<sub>Bi</sub>

この式から、各ペアごとの差を求めます。さらに、差diの平均値と分散Vdの算出を行います。

### 検定統計量t値の算出

今回は、以下の式で検定統計量t値が求まります。

![](./pic/03_33t.png)

### p値の算出

有意水準と比較する確率p値を求めます。
p値は、自由度&phi; = n - 1 のt分布において、|t|以上の値が発生する確率です。

### 判定

<dl>
<dt>p値 &le; 有意水準&alpha;</dt>
<dd>帰無仮説H<sub>0</sub>を棄却する</dd>
<dt>p値 &gt; 有意水準&alpha;</dt>
<dd>帰無仮説H<sub>0</sub>を棄却しない</dd>
</dl>

### JMPの操作

JMPを用いて、練習 3 に取り掛かりましょう。

&#9312; まず、表 3 を入力します。

- 1 列目は[列名]に `前期` と入力し、データタイプは[数値]、尺度は[連続尺度]
- 2 列目は[列名]に `後期` と入力し、データタイプは[数値]、尺度は[連続尺度]

このように列を作成してください。

{% screenshot 03_34newline.png "[前期]の列作成" %}

{% screenshot 03_35input.png "[前期]列、[後期]列のデータを入力" %}

&#9313; メニュー[分析] - [対応のあるペア]を選択します。

{% screenshot 03_36analysis.png "[対応のあるペア]を選択" %}

&#9314; [列の選択]の中にある[前期]をクリック - [Y,対応のある応答]をクリック - [列の選択]の中にある[後期]をクリック - [Y,対応のある応答]をクリック - [OK]をクリックします。

{% screenshot 03_37analysis.png "[前期]、[後期]を[Y,対応のある応答]に割り当て" %}

#### 出力結果

{% screenshot 03_38analysis.png "対応のあるペアの分析結果" %}

p値 = 0.0073 が求まりました。よって、p値 = 0.0073 &lt; 有意水準&alpha; = 0.05 であるので、帰無仮説H<sub>0</sub>は棄却されます。
前期の平均点 60.5833 と後期の平均点 68.75 には有意差があることがわかり、後期試験の成績（Ｂ）は、前期試験の成績（Ａ）よりも向上していると判断できます。


2つの母平均の差の推定（対応のあるデータ）
-----------------------------------------

母平均の差 &mu;<sub>B</sub> - &mu;<sub>A</sub> の (1-&alpha;) &times; 100％ 信頼区間は、以下の通りです。

![](./pic/03_39interval.png)


### JMPの操作

練習3を継続して用います。出力結果を見てください。

{% screenshot 03_40analysis.png "上側95% = 10.3006、下側95% = 2.03269" %}

"上側95％信頼限界"と"下側95％信頼限界"を読みます。
母平均の差 &mu;<sub>B</sub> - &mu;<sub>A</sub> の 95 ％信頼区間は、2.03269 &lt; &mu;<sub>B</sub> - &mu;<sub>A</sub> &lt; 10.3006 になります。
この間に 95 ％の確率で母平均の差があることになります。


課題1
-------

Ａ、Ｂの両地方で収穫した同種の大豆のタンパク質の含有率を調べたところ、次の結果が得られました。
含有率の正規性を仮定して、地方差が認められるか、有意水準 5 ％で検定してください。

表 4 ：Ａ、Ｂ地方の大豆のタンパク質含有率（％）

![](./pic/03_41Q.png)


課題2
-------

次のデータはＡ市内のあるレストランとＢ市内のあるレストランのアルバイトの時給を示しています。
2地域のレストランのアルバイトの時給に差はあるでしょうか。

表 5 ：Ａ市、Ｂ市のあるレストランのアルバイトの時給（円）

![](./pic/03_42Q.png)


課題3
-------

次のデータは 7 人があるダイエット法によりダイエットを行った前後の体重を表しています。
このダイエット法で体重の変化は見られたと言って良いでしょうか。
また、2つの母平均の差を信頼率 95 ％で区間推定してください。

表 6 ：あるダイエット法の前後の体重(kg)

![](./pic/03_43Q.png)
