---
layout: page
title: クエリ
date: 2015-03-23 17:01:14 +0900
purposes:
    - クエリの使い方を学ぶ
    - クエリを新規作成し、必要な形式で保存する
---

本教材に掲載する製品名は、一般に各開発メーカの商標、または登録商標です。

練習で使ったデータは必ず保存するようにしましょう


クエリ
--------------
前回から引き続いて、"Clist.accdb"を使用します。開いてください。
## デザインビューでクエリを作成する

### 1. [作成]タブ - [クエリ] - [クエリデザイン]を押します。
![](newquery1.png)
### 2. テーブルから"サークル名簿"を選択 - [追加]を押します。
![](newquery2.png)
### 3. クエリ デザイン ウィンドウにテーブルが追加されました。[閉じる]を押します。
![](newquery3.png)
### 4. "サークル名簿"の"会員ＩＤ"をダブルクリックします。すると、フィールドに会員ＩＤが追加されます。
![](newquery4.png)
### 5. 同様に以下を追加します。

    -   氏名
    -   シメイ
    -   入会年月日
    -   学部コース
    -   退会

![](newquery5.png)
### 6. ![](databaseview.png)（[表示]）もしくは![](action.png)（[実行]）を押します。
![](newquery6.png)
![](newquery7.png)
### 7. ![](quicksave.png)を押して、"入会日と所属"という名前でクエリを保存します。
![](newquery8.png)
![](newquery9.png)

このようにして、"入会年月日"と"学部コース"、"退会"情報に特化したクエリを作ることができました。

---
## 並べ替えを設定する

### 1. "デザインビュー"に切り替えます。
### 2. "シメイ"フィールドの並べ替えをクリック - "昇順"を選択します。
![](sortname1.png)
### 3. ![](databaseview.png)もしくは![](action.png)実行を押し表示を切り替え、上書き保存します。
![](sortname2.png)

"シメイ"の昇順、すなわちアイウエオ順に並べ替えられました。

---
## 単一条件で抽出する

### 1. [作成]タブ - [クエリ] - [クエリデザイン]を押します。
### 2. テーブルから"サークル名簿"を選択 - [追加]を押します。
![](abstract1.png)
### 3. フィールドリストのタイトルバーである"サークル名簿"をダブルクリックします。すると、サークル名簿内の全てのフィールドが選択状態になります。
### 4. 選択したもの全てをデザイングリッドにドラッグアンドドロップします。
![](abstract2.png)
![](abstract3.png)
### 5. "シメイ"フィールドを選択 - キーボードの[Delete]キーを押して削除します。
![](abstract4.png)
### 6. 同様に"自宅TEL"フィールドも削除します。
### 7. "都道府県"フィールドの抽出条件に"東京都"と入力 - [Enter]キーを押します。
![](abstract5.png)
### 8. ![](databaseview.png)もしくは![](action.png)を押します。
![](abstract6.png)

これで、東京都の会員だけが抽出されました。"東京都会員"と入力して、保存します。

---
## OR条件で抽出する

### 1. "デザインビュー"に切り替えます。
### 2. "都道府県"フィールドの「または」に"神奈川県"と入力 - [Enter]キーを押します。
![](or1.png)
### 3. ![](databaseview.png)もしくは![](action.png)を押します。
![](or2.png)

これで、東京都と神奈川県の会員だけが抽出されました。

---
## AND条件で抽出する

### 1. "デザインビュー"に切り替えます。
### 2. "都道府県"フィールドの「または」に入力されている"神奈川県"を選択 - [Del]キーを押して、削除します。
### 3. "退会"フィールドの抽出条件に半角で"yes"と入力 - [Enter]キーを押します。
![](and1.png)
### 4. ![](databaseview.png)もしくは![](action.png)を押します。
![](and2.png)

これで、東京都でかつ退会した会員だけが抽出されました。

---
## ワイルドカードを利用して抽出する

 - 「＊（ワイルドカード)」は、任意の文字列を表しています。つまり、"学部コース"フィールドに"都市教養学部*"と入力すると、先頭に"都市教養学部"がついていればその後ろの文字列に関係なく抽出します。

### 1. "デザインビュー"に切り替えます。
### 2. "都道府県"フィールドの抽出条件に入力されている"東京都"を削除 - "退会"フィールドの抽出条件に入力されている"Yes"を削除します。
### 3. "学部コース"フィールドの抽出条件に"都市教養学部*"と入力 - [Enter]キーを押します。
![](wildcard1.png)
![](wildcard2.png)
### 4. ![](databaseview.png)もしくは![](action.png)を押します。
![](wildcard3.png)

これで、都市教養学部の会員だけが抽出されました。

---
## 一定範囲を指定してデータを抽出する

### 1. "デザインビュー"に切り替えます。
### 2. "学部コース"フィールドの抽出条件に入力してある"Like"都市教養学部*""を削除します。
### 3. "入会年月日"フィールドの抽出条件に半角で"Between #2007/1/1# And #2007/12/31#"と入力 - [Enter]キーを押します。
![](between1.png)
![](between2.png)
### 4. ![](databaseview.png)もしくは![](action.png)を押します。
![](between3.png)

これで、2007 年 1 月 1 日から 2007 年 12 月 31 日までに入会した会員だけが抽出されました。[ファイル]タブ - [オブジェクトに名前を付けて保存]を押し、"2007年入会会員"という名前で保存します。
![](between4.png)
![](between5.png)

課題 1
--------------
### "congress"の"会員名簿"テーブルを基に次の指示に従ってクエリを作成し、並べ替えや条件の設定を行ってください。

    -   "会員名簿"テーブルを基に、デザインビューでクエリを作成して実行し、名前を付けて保存してください。
    -   表示するフィールド：会員ＩＤ、氏名、シメイ、入会年月日、職種、退会
    -   クエリ名：入会日と職種
    -   "入会日と職種"クエリに抽出条件と並べ替えを設定して実行し、名前を付けて保存してください。
    -   抽出条件："職種"が"大学"から始まる語で、"退会"が"No"の顧客

> ヒント：ワイルドカードを使いましょう。

    -   並べ替え："シメイ"の昇順
    -   クエリ名：大学関係者
    -   "大学関係者"クエリの抽出条件を削除した後に、以下のように変更して実行し、名前を付けて保存し直してください。
    -   抽出条件："入会年月日"が"2009/1/1"から"2009/12/31"までの顧客（元々の抽出条件は削除）
    -   クエリ名：2009年入会顧客
    -   "2009年入会顧客"クエリを閉じます。

作成者：首都大学東京 大学教育センター 情報教育担当
