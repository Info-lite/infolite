---
layout: page
title: Accessの概要とテーブル
date: 2015-03-23 17:01:14 +0900
purposes:
    - データベースソフトについて学ぶ
    - Microsoft Accessの基本操作を学ぶ
    - 新しいテーブルを作成する
---


今回使うファイルです。ダウンロードしてください。

Clist(fin).accdb
Clist.xls
gradetype.accdb
congresslist.xls
membertype.accdb

Microsoft Accessについて
--------------
![](./pic/accesslogo.png)

Microsoft Accessは、Microsoft社が開発したリレーション（関係）型データベースソフトウェアです。

大量のデータを入力、保存することができ、そのデータを必要に応じた形で表示したり、印刷したりすることができます。

大きな特徴は、データ間のリレーションシップ（関係）に基づいて、データを処理することができるということです。

### Microsoft Excelとの違い

Microsoft Officeには、Accessの他にデータを操作するソフトウェアとしてExcelがあります。しかし、Accessはデータベースソフトウェアと呼ばれる一方で、Excelは表計算ソフトと呼ばれ、それぞれ特長を持っています。

-   Excelの特長
    -   データはセルに直接入力する
    -   自由に入力することができる
    -   計算はセルに直接計算式を入力する
    -   シートに表された形で印刷する

-   Accessの特長
    -   データはテーブルに入力する
    -   同じ列には同じ型のデータしか入力することはできない
    -   クエリを使うことによって、複数のデータテーブルを組み合わせ、様々な形で設定できる
    -   計算にはクエリを使用する
    -   レポートで任意の形で印刷することができる


Microsoft Accessの基本操作
--------------
### ウィンドウ構成

-   各部の名称
![各部の名称](./pic/window.png)

### クイックアクセスツールバー
![クイックアクセスツールバー](./pic/quick.png)

よく使うコマンドを表示しておくことができます。

初期設定では、![](./pic/quicksave.png)
（[上書き保存]）、![](./pic/quickreturn.png)
（[元に戻す]）、![](./pic/quickrepeat.png)
（[繰り返す]）が表示されています。

![](./pic/quick_more.png)
を押すと、表示するコマンドのカスタマイズができます。

### リボン
データベースを作成していく際によく利用するコマンドを割り当てたボタンが機能ごとにパネルに分類され、配置されています。

リボン上部のタブ状になった[ホーム]、[作成]、[外部データ]、[データベース ツール]をクリックすることによって、 各機能のパネルに切り替えることができます。もしくは、カーソルがリボン上にあるときにホイールを回すと、切り替えることができます。

-   ホーム：フォントの設定や並び替え、検索などを行う事が出来ます。
![](./pic/ribbon1.png)

-   作成：テーブル、フォーム、レポートおよびクエリやマクロはここで作成する事が出来ます。
![](./pic/ribbon2.png)

-   外部データ：他のAccessやExcelなどのデータをインポートしたり、ExcelやPDF形式のファイルにエクスポートしたりできます。
![](./pic/ribbon3.png)

-   データベース ツール：マクロの設定や、リレーションシップの設定などを行う事が出来ます。
![](./pic/ribbon4.png)

パネルの右下にある![](./pic/details.png)
を押すと、より詳しく各項目を設定することができます。
![](./pic/ribbon_details.png)
![](./pic/fontwindow.png)

また、カーソルを使用したいコマンドの上で静止させると、そのコマンドの説明を見ることができます。

### Microsoft Accessの起動

1. [スタート] - [プログラム] - [Microsoft Office] - [Microsoft Office Access]をクリックします。
起動画面
![](./pic/home.png)


### データベースを開く

1. （[ファイルメニュー]） - [開く]をクリック - 先ほど保存した"Clist(fin)"を選択 - [開く]をクリックします。
![](./pic/open1.png)
![](./pic/open2.png)


2. セキュリティの警告が出ているので解除します。[コンテンツの有効化]をクリックします。
![](./pic/security1.png)


### ナビゲーションウィンドウの操作

Access2010では、ウィンドウ左に表示される"ナビゲーション ウィンドウ"を使って テーブルやフォームなどの一覧を表示させることができます。

カテゴライズの方法とフィルタの設定がここで行えます。
![](./pic/navi1.png)


### テーブルを開く

ここからは、Accessの基本である「テーブル」「フォーム」「クエリ」「レポート」の開き方を見ていきます。

テーブルは、データを蓄積し、表として保存しておくものです。同じ行のデータはそれぞれ対応関係にあります。列（フィールド）はデータの各項目を表しており、特定の型が設定されます。その型以外のデータは保存することはできません。

1. すべてのAccessオブジェクトから[サークル名簿]を開きます。
![](./pic/readlist1.png)
![](./pic/readlist2.png)

2. [ホーム]リボン（もしくは[データシート]リボン） - [表示] - ![](./pic/designview.png)
（[デザイン ビュー]）をクリックしてデザインビューに切り替えます。
![](./pic/readlist3.png)
![](./pic/readlist4.png)

3. デザインビューに切り替わりました。デザインビューは、テーブル以外にもあり、レイアウトの変更やフィールドの設定変更などを行うことができます。
4. [ホーム]リボン（もしくは[デザイン]リボン） - [表示] - ![](./pic/databaseview.png)
（[データベース ビュー]）をクリックすると、元に戻ります。
![](./pic/readlist5.png)


### フォーム

フォームは、テーブルに保存されているデータを、また入力用のウィンドウをどのように表示するか設定するものです。フォームを作成すると1つのレコードを1つのウィンドウに表示することができるので、入力作業を効率的に行うことができます。

1. すべてのAccessオブジェクトから[会員情報]を開きます。
![](./pic/readinfo1.png)
![](./pic/readinfo2.png)


2. [ホーム]リボン - [表示] - ![](./pic/layoutview.png)
の（[表示]）の部分をクリックして、[デザインビュー]をクリックします。
![](./pic/readinfo3.png)
![](./pic/readinfo4.png)


3. デザインビューに切り替わりました。[ホーム]リボン（もしくは[デザイン]リボン） - [表示] - ![](./pic/formview.png)
（[データベースビュー]）をクリックすると、元に戻ります。
![](./pic/readinfo5.png)


### クエリ

クエリは、テーブルに蓄積されたデータをどのような形に加工するか設定するものです。複数のテーブルの必要な部分だけを引き出したり、関連性のあるデータ同士をリレーションシップによって接続することなどができます。

1. すべてのAccessオブジェクトから[入会日と所属]を開きます。
![](./pic/readcourse1.png)
![](./pic/readcourse2.png)


2. [ホーム]リボン - [表示] - ![](./pic/designview.png)
（[デザイン ビュー]）をクリックしてデザインビューに切り替えます。
![](./pic/readcourse3.png)
![](./pic/readcourse4.png)


3. デザインビューに切り替わりました。[ホーム]リボン（もしくは[デザイン]リボン） - [表示] - ![](./pic/databaseview.png)
（[データベース ビュー]もしくは[実行]）をクリックすると、元に戻ります。
![](./pic/readcourse5.png)


### レポート

レポートは、クエリなどでデータの集合をどのようなデザインで表示するかを設定するものです。フォームとの違いは、フォームは 1つのレコードについて各項目を表示するのに対し、レポートはデータの抽出や集計を実行した結果の報告書を作成したりできます。

1. すべてのAccessオブジェクトのフォームにある[入会日リスト]を開きます。
![](./pic/readjoin1.png)
![](./pic/readjoin2.png)

2. [ホーム]リボン - [表示] - ![](./pic/databaseview.png)
の（[表示]）の部分をクリックして、[デザイン ビュー]に切り替えます。
![](./pic/readjoin3.png)
![](./pic/readjoin4.png)


3. デザインビューに切り替わりました。[ホーム]リボン（もしくは[デザイン]リボン） - [表示] - ![](./pic/reportview.png)
（[データベース ビュー]）をクリックすると、元に戻ります。
![](./pic/readjoin5.png)

データベースの作成
--------------
### 新しいデータベースの作成

1. （[ファイルメニュー]） - [新規作成]をクリックします。
![](./pic/new1.png)

2. [空のデータベース]の下のファイル名入力欄に"Clist"と打ち込み、[作成]をクリックします。
![](./pic/new2.png)
![](./pic/new3.png)

3. 新しいデータベースが作成されました。


### テーブルの作成

既にテーブルが開かれているのでこれを編集していきます。

1. まず、デザインビューに切り替えます。[ホーム]リボン - [表示] - [データベース ビュー]をクリックしてデザインビューに切り替えます。
2. 名前を付けて保存ウィンドウが表示されるので"サークル名簿"と入力し、[OK]をクリックします。
![](./pic/field1.png)
![](./pic/field2.png)


3. フィールド名の項目に以下の 11 個の要素を入力していきます。
    -   会員ID（すでに「ID」と入力されている部分を「会員ID」に変更する。）
    -   氏名
    -   シメイ
    -   郵便番号
    -   都道府県
    -   市区町村
    -   自宅TEL
    -   入会年月日
    -   学年ID
    -   学部コース
    -   退会

![](./pic/field3.png)

これでフィールド名の入力が終わりました。次に、データを入力する際に便利な機能を各フィールドに付与していきます。


### ふりがなウィザードでプロパティを設定

1. "氏名"をクリック - フィールドプロパティのふりがなの項目をクリックします。横に表示された[…]というボタンを押します。
![](./pic/furigana1.png)

2. 警告が出るのでテーブルを保存します。
![](./pic/furigana2.png)

3. ふりがなウィザードの"既存のフィールドを使用する"にチェックを入れ、[シメイ]を選択します。
4. さらにふりがなの文字種に[全角カタカナ]を選択し、[完了]を押します。
![](./pic/furigana3.png)

5. フィールドのプロパティを変更します。[OK]をクリックします。
![](./pic/furigana4.png)

これで、"氏名"のフィールドに入力すると、"シメイ"のフィールドに全角カタカナでふりがなが入力されるようになりました。


### 住所入力支援ウィザードでプロパティを設定

1. "郵便番号"をクリック - フィールドプロパティの住所入力支援の項目をクリックします。横に表示された[…]を押します。
![](./pic/zipcode1.png)

2. 住所入力支援ウィザードの郵便番号に[郵便番号]を選択 - [次へ]を押します。
![](./pic/zipcode2.png)

3. 住所の構成の中から"都道府県と住所の 2 分割"にチェック - 都道府県に[都道府県]を選択 - 住所に[市区町村]を選択 - [次へ]を押します。
![](./pic/zipcode3.png)

"郵便番号"に自分の家の郵便番号を入力してみましょう。"都道府県"と"市区町村"に住所が表示されます。

4. [完了]を押します。
![](./pic/zipcode4.png)

5. フィールドのプロパティを変更します。[OK]をクリックします。
![](./pic/zipcode5.png)

上で試したように、これで"郵便番号"を入力すると、"都道府県"と"市区町村"に住所が入力されるようになりました。


### フィールドサイズの変更

1. "学年ID"をクリック - フィールドサイズを"255"から"5"と入力し直します。
![](./pic/fieldsize.png)


### IMEモードの変更

1. "自宅TEL"をクリック - IME 入力モードを[オン]から[オフ]に変更します。
![](./pic/tel1.png)

これで"自宅TEL"に入力しようとしたとき、日本語入力がオフになります。


### 定型入力プロパティの設定

1. "入会年月日"の右横にある"テキスト型"を"日付/時刻型"に変更します。
![](./pic/join1.png)

2. "入会年月日"をクリック - 定型入力の項目をクリック - 横に表示された[…]を押します。
![](./pic/join2.png)

3. 警告が出るのでテーブルを保存します。
![](./pic/join3.png)

4. 定型入力名の中の[日付（S）]を選択 - [次へ]を押します。
![](./pic/join4.png)

5. さらに、[次へ] - [完了]を押します。
![](./pic/join5.png)
![](./pic/join6.png)


これで、"入会年月日"に入力したとき、年/月/日の形で入力されるようになりました。


### データ型の変更

1. "学年ID"の右横にある"テキスト型"を"数値型"に変更します。
![](./pic/grade1.png)

2. 次に、"退会"の右横にある"テキスト型"を"Yes/No型"に変更します。
![](./pic/quit1.png)

3. "退会"をクリック - [ルックアップ]タブの"表示コントロール"を"チェックボックス"に変更します。
![](./pic/quit2.png)


### データの入力

1. [ホーム]リボン - [表示] - ![](./pic/databaseview.png)
（[データベース ビュー]）をクリックして、データシートビューに戻ります。以下のデータを入力してみてください。
    -   氏名：山本伊平（ヤマモト イヘイ）
    -   郵便番号：221-0023
    -   市区町村：横浜市神奈川区宝町5-5-0
    -   自宅TEL：045-231-0000
    -   入会年月日：2009/10/01
    -   学年ＩＤ：1
    -   学部コース：都市教養学部都市教養学科生命科学コース
![](./pic/yamamoto1.png)


### Excelデータのインポート

1. まず、サークル名簿を開いていたら、閉じます。
2. [外部データ]リボン - [インポート] - ![](./pic/excelimport.png)
をクリックします。
![](./pic/excelimport1.png)

3. [参照]ボタンを押し、先ほどダウンロードした"Clist.xls"を選択します。
4. "レコードのコピーを次のテーブルに追加する"にチェックを入れ、"サークル名簿"を選択し、[OK]を押します。
![](./pic/excelimport2.png)

5. [次へ]をクリックします。
![](./pic/excelimport3.png)

6. [完了]を押します。
![](./pic/excelimport4.png)

7. [閉じる]を押してインポートを完了します。
![](./pic/excelimport5.png)

このようにExcelのファイル内に保存されているデータをAccessにインポートすることができます。
![](./pic/excelimport6.png)


### Accessテーブルのインポート

1. [外部データ]タブ - [インポート] - ![](./pic/accessimport.png)
をクリックします。
![](./pic/accessimport1.png)

2. [参照]ボタンを押し、先ほどダウンロードした"gradetype.accdb"を選択し、[OK]を押します。
![](./pic/accessimport2.png)

3. "月会費"を選択 - [OK]を押します。
![](./pic/accessimport3.png)

4. [閉じる]を押してインポートを完了します。
![](./pic/accessimport4.png)

月会費
![](./pic/accessimport5.png)


このように元々作られていたAccessのテーブルをインポートし、クエリを用いて関連づけをすることができます。

課題 1
--------------
学会の入会日リストを管理するデータベースを作成し、"会員名簿"テーブルを作成します。テーブルのデータはExcelファイルからインポートします。以下の指示に従って、作成してください。

1. 空の"会員管理"データベースを作成してください。名称は"congress"にしてください。
2. 次のフィールドを含む"会員名簿"テーブルを作成してください。
    -   テーブル名：会員名簿
    -   フィールド名：氏名、シメイ、郵便番号、都道府県、市区町村、自宅TEL、入会年月日、会員タイプ、職種、退会
    -   フィールド名の変更：ＩＤ　→　会員ＩＤ
    -   主キー：自動的に設定される
3. "氏名"フィールドに氏名を入力すると、"シメイ"フィールドに全角カタカナのフリガナが自動的に表示されるようにしてください。
4. "郵便番号"フィールドに郵便番号を入力すると、住所が"都道府県"フィールドと"市区町村"フィールドに自動的に表示されるように設定してください。
5. "自宅TEL"フィールドのIME入力モードプロパティをオフに設定してください。
6. "入会年月日"フィールドの定型入力プロパティにデータ入力時の書式として日付（Ｓ）（年／月／日）を設定してください。
7. デザインビューで以下のフィールドを設定してください。
    -   "入会年月日"フィールドのデータ型は[日付／時刻型]
    -   "会員タイプ"フィールドのデータ型は[数値型]
    -   "退会"フィールドのデータ型は[Yes／No型]
8. "会員名簿"テーブルに、Excelファイルの"congress.xls"からデータをインポートしてください。
9. 新規レコードに次のデータを入力してください。
    -   会員ＩＤ：21（自動入力）
    -   氏名：佐川亮子
    -   シメイ：サガワリョウコ（自動入力）
    -   郵便番号：160-0022
    -   都道府県：東京都（自動入力）
    -   市区町村：新宿区新宿6-6-0（自動入力だが、番地は手入力する）
    -   自宅TEL：03-3330-0000
    -   入会年月日：2009/09/26
    -   会員タイプ：2
    -   職種：大学生
    -   退会：オフ
10. "会員管理"データベースにaccessファイル"membertype.accdb"データベースの"会員タイプ"テーブルをインポートしてください。
