---
layout: appendix
title: 無限ループ
date: 2022-04-01 00:00:00 +0900
---

ここでは、無限ループについて紹介します。

無限ループ
----------------

繰り返しを行う際に最も注意しなければならないのが**無限ループ**です。

繰り返しは条件を満たしている限り繰り返し処理内容を繰り返します。しかし、場合によっては、繰り返しの条件を満たし続けてしまい、繰り返しが終了しない場合があります。そのような場合を<span style="color: red;">**無限ループ**</span>と呼びます。

For ～ Next文の場合は、例えば、加算値に負の値を指定することもできます。例えば、以下のような書き方をした場合です。

*無限ループするソースコードの例*

    For i = 1 To 5 Step -1  
    繰り返し処理内容  
    Next i  

この場合、1は繰り返し処理内容が終わる度に、-1が加算され、iの値は繰り返す度に小さくなっていき、終了値の5を超えることはできません。よって、常に条件を満たし続けて、無限ループしてしまいます。

加算値に負の値を指定する場合は、終了値も初期値よりも小さくならなければ、無限ループしてしまいます。加算値に負の値を指定する場合でも、以下のような場合であれば、無限ループさせずに済みます。

*加算値が負の数でも無限ループしないソースコードの例*

    For i = 1 To -5 Step -1  
    繰り返し処理内容  
    Next i  

繰り返しの方法は、今回扱ったもの以外にも多くのパターンがあります。条件をどのように満たさなくするか、繰り返しを用いる際は必ず無限ループさせないように設計することが非常に重要となります。

Excelのマクロで無限ループをしてしまったら
----------------

Excelのマクロで無限ループしてしまったら、以下のキー操作を試してみましょう。

* [Ctrl]キーと[Break]キーを同時に押す
* [Alt]キーと[Esc]キーを同時に押し続ける

どちらかでExcelのマクロが強制終了するはずです。

どちらのキーが効くかは、作成したプログラムの内容によって異なります。

上記のいずれかでも応答しない場合は、[Ctrl]キーと[Alt]キーと[Del]キーを同時に押して、タスクマネージャーを起動させ、Excelを強制終了するのが良いでしょう。

情報処理教室で作業している場合は、担当教員やtutorに助けを求めるのも良いでしょう。


