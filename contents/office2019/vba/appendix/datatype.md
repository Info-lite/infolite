---
layout: appendix
title: 主なデータ型
date: 2022-04-01 00:00:00 +0900
---

ここでは、主なデータ型について、サンプルプログラムを踏まえて、確認を行います。

主なデータ型
----------------

VBAの主な基本データ型には以下のようなものがあります。

{% screenshot xxx.png "主なデータ型" %}

整数型と浮動小数点数型
----------------

データ型を考える際に注意をしなければならないのは、データ型によって扱える値の内容と値の範囲が異なるという点です。変数の宣言は、最適なデータ型を選んで宣言することになります。

まず、変数として扱う値は、数値なのか、その他なのかを考える必要があります。同じ数値を扱うデータ型であっても、整数型と浮動小数点数型の区別があり、整数型には小数点以下が含まれている数値を格納することはできません。

次のAdditionとDivision1、Divisionのマクロを作成し、実行して比べてみるとわかりやすいでしょう。

*Additionのソースコード*

    Sub Addition ()
        ' 変数宣言
        Dim x As Integer, y As Integer, z As Integer
        
        ' 変数に値の代入
        x = 30
        y = 20
        z = x + y
        
        ' メッセージ表示
        MsgBox (x & "たす" & y & "は" & z)
    End Sub


※MsgBox()内で変数と普通の文字列を組み合わせる場合は、その間に「&」を入れると組み合わせることができます。

{% screenshot xxx.png "Additionの実行結果" %}

Additionでは、整数型(Integer型)の変数を組み合わせて、計算を行い、その結果を表示しました。正しい結果を得ることができました。

続いて、以下のDivision1のマクロを作成し、実行してみましょう。

*Division1のソースコード*

    Sub Division1()
        ' 変数宣言
        Dim x As Integer, y As Integer, z As Integer
        
        ' 変数に値の代入
        x = 30
        y = 20
        z = x / y
        
        ' メッセージ表示
        MsgBox (x & "わる" & y & "は" & z)
    End Sub

{% screenshot xxx.png "Division1の実行結果" %}

上記のようなメッセージが結果として表示されますが、この計算結果は正しくありません。30わる20は、1.5です。しかし、用いた変数が整数型(Integer型)であったため、小数点以下を用いることができず、結果として、四捨五入された整数の値に変更されてしまいました。Additionでは、小数点以下が生じることはなかったため、問題なく正しい結果を得ることができましたが、Division1では、小数点以下が生じるので、正しい結果を得ることができなかったというわけです。

それでは、小数点以下を扱うことができる浮動小数点数型(Single型)を用いた割り算のマクロであるDivision2を作成して、正しい結果が得られるか確認してみましょう。

*Division2のソースコード*

    Sub Division2()
        ' 変数宣言
        Dim x As Single, y As Single, z As Single
        
        ' 変数に値の代入
        x = 30
        y = 20
        z = x / y
        
        ' メッセージ表示
        MsgBox (x & "わる" & y & "は" & z)
    End Sub

{% screenshot xxx.png "Division2の実行結果" %}

Division2では、正しい結果を得ることができました。このように、整数のみを扱う整数型と小数点以下も扱える浮動小数点数型の大きく分けて二種類の数値のデータ型があり、目的に応じて、適切なデータ型を選択して利用することが重要です。上記のような結果を見ると、なんでも浮動小数点数型を用いた方が良いと考えがちですが、それぞれのデータ型には、主なデータ型の表に示されたとおりに扱える範囲とそのために必要なサイズが決められています。変数を作成する際には、このサイズに応じた容量をメモリ内に確保する必要があります。近年のコンピュータは大容量のメモリを搭載するようになったため、メモリ容量を枯渇させるほどプログラムで変数を用いることは多くはありません。しかし、より高度で複雑なプログラムを作成する場合は、多数の変数を必要とすることになりますので、メモリ容量を枯渇させないようにしなければなりません。メモリ容量が枯渇すると、コンピュータの動作に悪影響を及ぼしますので、注意が必要です。

同一種類だが、範囲の違うデータ型の選び方
----------------

IntegerとLongやSingleとDoubleの違いも値の範囲とメモリ容量の問題から扱う値に応じて、どちらを扱うべきなのか選択します。大きな値を扱う必要がないのであれば、サイズが小さいデータ型を選んだ方がメモリ容量の節約になるでしょう。
数値を扱うデータ型の他に文字列型やオブジェクト型など、主なデータ型の表には書かれていない様々なデータ型もあります。変数を作成する際には、これらのデータ型を考慮して作成することが必要となってきます。









